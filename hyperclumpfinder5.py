
#2016 Jorge Canelhas
import sys
import copy

f=open('E-coli.txt','r')
l1=f.readline().strip()
l2='9 500 3'
#lines = sys.stdin.read().splitlines()
#l1=lines[0]
#l2=lines[1]
count=0


def CumputeNumberToPatern(number,ndigits):
    dic={'0':'A','1':'C','2':'G','3':'T'}
    patern=''
    #if number == 0:
    #    return [0]
    digits = []
    while number:
        digits.append(int(number % 4))
        number /= 4
        number=int(number)
    for i in digits[::-1]:
        patern=patern+dic[str(i)]
    if len(patern)<ndigits:
        for i in range(0,ndigits-len(patern),1):
            patern=dic['0']+patern
    return patern

def locate_clumps(gene,size):
    clumplist=dict()
    positions=list()
    codelen=len(gene)+1

    for n in range(0,codelen-size,1):
        kmer=gene[n:n+size]

        if clumplist.get(kmer, [])==[]:
            clumplist[kmer]=[n]
        else:
            positions[:]=[]
            positions=copy.copy(clumplist[kmer])
            dbg=len(positions)
            dbg=positions[len(positions)-1]
            if n-positions[len(positions)-1]>size-2:  #da correcto com size-2
                positions.append(n)
                clumplist[kmer]=copy.copy(positions)

    return clumplist

def superclumpfinder(gene,clumpsize,windowsize,minscore):
    clumplist=dict()
    tmplist=list()
    clumplist=locate_clumps(gene,clumpsize)
    finaldict=dict()

    for i in clumplist:
        dbg=len(clumplist[i])-minscore
        for k in range(0,len(clumplist[i])-minscore+1,1):
            tmplist[:]=[]
            tmplist=copy.deepcopy(clumplist[i])
            dbg=tmplist[k]
            dbg=tmplist[k+minscore-1]
            dbg=tmplist[k+minscore-1]-tmplist[k]
            if tmplist[k+minscore-1]-tmplist[k]<=windowsize-clumpsize:
                finaldict[str(i)]=clumplist[str(i)]
    return finaldict


#l1='ACGTACGT'
#l2='1 5 2'
#l1='AAAACGTCGAAAAA'
#l2='2 4 2'
#l1='CCACGCGGTGTACGCTGCAAAAAGCCTTGCTGAATCAAATAAGGTTCCAGCACATCCTCAATGGTTTCACGTTCTTCGCCAATGGCTGCCGCCAGGTTATCCAGACCTACAGGTCCACCAAAGAACTTATCGATTACCGCCAGCAACAATTTGCGGTCCATATAATCGAAACCTTCAGCATCGACATTCAACATATCCAGCG'
#l2='3 25 3'
#l1='CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA'
#l2='5 50 4'
#l1='TTGCAGGGATAGCTGTAGAGCGCCTCTAGCCCTCAAACTCTATGTTGTGAGAGTCTGGCGACATACGTTATGGCCAATAGGATTCGTAGCCGCGGGTACACTATATTAGTTTACCGTAGCACCACACCCCTCATGACGTTAAGCCAGGGTACGGGCAGAAACACGGTACAAACGCCTCTCGCATCTCACAACGACATTCCAGCCCAGTCCCGAGCTAACGACTAAGGGATCTCCCGTTAACTGCTTCCTCACGTAATGAGTTGGTGTACTCTCTATAAATGGGTGTACTCTCGGTTTACACGCCAGGGCGACAGTGACATGCAGGGGACTCCCACTATGACCATGATTTCGCAATGGCAGGCCACGCCGTTACAGTCTATTGGCCAGTCTATTCGGCCCTACAGCCACATGATCGAGGCCCTGGCAAACGTGGTTCATATAAATTCGGTCCTTAGTCCATGAATTGCCTGTCAGCTACCGTAAATCGCGCAATGGTCGCACAAGGGTCCCCCGCGTCTGAGCTGTTCGGCGGAAGGCCAATACCGCTACGTATTTGGTTAAGTGCAAGTATGGACTGTTTAAATCAATTAATAAGTAATCCCAGTAATCCCCAGTGCTCCCGTTGGATCAGAGTTCTGAGTGTTAACGTAGGTACGTATAGCCGGGAGAACCATAAGTGCTTGATCGATGAGCGAGCAGGCACGCAAGCGGTGCGAGTGCACTCATAAAAGCTTGGTCACGTTCCAGCCGGGAATCGATTCCCAGGGAACTGGGAAAGACGATCGCACTAATGCGCCCAGAATCGGTTAGTCGGTTAGAATTCTTTAGCTGGTCGACATTCTCTGTTTCCGTCACCGCCTAAATGACTGACTCCAGTGAAAACGTCTAGAGTACGCTGCTAGATGGAGCGACGCATTGGCCAACATGCCCATCCTTCTTAGAAGCATTATACCAGGACCCTGCCATTATGTCGTCCTACTTCTAATAGTGATAGTCGCCTGAAGTTGGAGGACCGTCTCTTATTAAAATCCGACGTAAGGGCTAAATTTATCACGTTGAACTTTGGGGTCCGGGCCCTGGGTGGGAGATTATTGTGCCGTTTTCGCCGGTCAGCTCTCCGATTTTACGATAGACGTTCGTACGGATGTCCGCGACGGTCCGAGACCGGCAGCAATATGTTCAGTCGGCATCAGAGCTATGTTCCCAGACTGCCCCGGGGTGCGCCTGGATAGGAGATTTCAGGATTCGCTAACTGCTTACGTATGGGCGCGCACATGTTACCCGTGCTGTAACACTGCTCGAAGTCCCTTAATAGTGTGACGACTATCCAATCTTCAGATGTTCTGGCTGATTCCTATGCTCGAACGTGATGCGTCCCACTCAGATAATCTAGCCCGTGTTTGGCCTAGCCGAGTATTCGTATAGAGCCCGGACCCTTTAAGTGCATCGAGGTGTTTAAGTGCAAGCAGTTTAAGTGCACTTTTAAGTTTAAGTGCAGTATGTACGGCCCCACCTAGAAGTGATCCGTTTAAGTGCACGTTTTAAGTGCACAGCAGTTCTGGCAGCAGATTATCCTTTTTTAAGTGCAGTGCACTATTTAAGTGCAAGTATCCACCTTGGTCAAGGATATCTCTTTAAGTGTTTAAGTGCATGGAGGAGGGTAGGTCCTTTTAAGTGCACAGCTTTTATTTAAGTGCATCGGCTTTAAGTGCAGTATTGTTCTACAATATACGTTCTCGAGTGGCGGAGTCTTACTCTAAAATTTGTGACTATTTAAGTGCACCTTTAAGTGCACATTTTTATTTAAGTGCAGTGCAATACGTTTAAGTGCACTTTTTTGCGCTCAGTGGTGCCACCATGGTACTTTAAGTGCATTTAAGTGCATGCATAAGTGCATAGGCCAGCGCTGCAAAATTTAAGTGCATTTTTAAGTTTTAAGTGCATAAGTGCATTTAAGTGCATCTCTCGTTAGGCATCTTAGATTTAATTTAAGTGCAAAGTGCACAATAGTTACACCCTAAATCCTATATACACCGACACCCCAACTTGAATCCTGCATTAGCAAACTCTAGGCGCTTGGACTTGTCCATCATTCTCCCCCTACCTAGTTTGGCATCGTCAGCACATCGTGAGATGATTGAAATTTACATAGCGATTGTTGACGTTTCCGCATCATGACGAGTTTCATTGGTGAGTAGCTCACCAGGGGACGGAAATTCTTTCTTTCTGATCGACAGTCGTAACTTTGCACACGCGCAGCTCTGTGCGCAATCAACTGGCATCGCAATCCCAATAGCAGGCATCAAACTGAGGAGGAAGAGCGAGGATAGACGCATCCGATAGGAGCCTTCTTCGGTAAAGATACTGCATCCGTATGTCACGGCCAAGGAGTTACCATTCATGTCCGATTTCCATGTTGTGACTCAAGGAAGTTTAGGGGAATTTACAACTTCCACCTAAGAAGTTTGTTTTCAAGGGACCTCCCAGAGAGGATCGTGTGAAGGAGGAAGGCGTAAAGTCCGACTTTCTTGGCAATGGGACATTTTCGGGTGAAGTATGAGCTATGGAGCTTAAACGAAATACGCTTATGCAGAAGCTGGCGCTGTGATAGCTCCGACGTTCACGTTGGGCACCCCAAGGGACGTTGACGTTCACGTTCGGCGCTAGCCTGTAAATTCCGGCGCTAGCCGCTAGCGCGCTAGCCGGCGCTAGCACCCGCGCAAAGGCGGCATGCCGGCGCTAGCAGCCGCTAGCCGCTCTAGGAGCGGCGCTAGCGCGGCGCTAGCCCAGACGTTCACGCGGCGCTAGCGCTAGCGCTCGTAGTCGAACGGCCGGCGCTAGCTTGCACTGGGCGACGTTCACCGGCGCTAGCGCGCTAGCAACACGGCGCTAGCGCGGCGCTAGCGCGGACGAGGACGCGCGGCGCTAGCACGGCGGCGCTAGCGGACGTTCCGGCGCTAGCGAGGACGTCAGACGAGGACGCAGGGACGAGGACGTGACGAGGACGCGACGAGACGAGGACGATGCGGCGCTAGCCGAGACGAGGACGTTGTTGGGACTGACGAGGACGGGACGCGACGAGGACGCGTTCACGCGCCGGCGCTAGCCGCTAGCTGACGACGAGGACGACGACGACGAGGACGACGACGTGACGTTCACGTTATCGGCGCTAGCCTAGCGGCGCTAGCGCGCTCGGCGCTAGCGCTAGCGTGCAAATCAAGGAATCGGCGCTAGCACGGACGAGGACGGTCCTTTGTGCCGGTCAGGCTGTGACGAGGAGACGAGGACGAATGGAGGACGAGGACGTTTGACGACGAGGACGAGGACGAGGACGCTTCTCACCCGATTCTGGAGGTAACACACAATCGGACGAGGACGTGGAGGACGAGACGAGGACGAGGACGCGTTGACGAGGACGCGAGAACATGCGACATCGACCCAGGTGACCTACTGCGGAGTATTCCAGATGACCCCCATACAGGTTTCGATGGGTTTCAGCAAAAGCCTTGTAAGAACTTTGTCACTGGTTGATGCAAAGAACGACTGCCCCCAACACCACCATAGCTACAAAGACCGGACAACATGTCTTTAGGGTTTCGTATGGGGTATGCTCGCTCCCTGACGCAGAATCCGTCTACAGCTGGTCATGTGGCGCCTCGCAGCACACTGATCACTTTGCTTCCAATAGGAATAAATGCTGACCCCTTATGTAGAGGCCCCGCCGTGAGAAGGTATGCTGCACTTAAACTGTGTGCCCCTACCCGCGTTATAAATTGACTTAAGGCGAGTGAGAAAGGATACGTTTGCCTCTACGCTTCGCCGGGTTTTCCGTACATACCGTCAAGCAGCTCGACTTATGGGAATAGCCTGGGGGATTATTGAGTTGTCCGCCCGGTCGCTGCTCCTATAGGCTCTGTCTGCCCTTATGCCCGTACGCAGCCAATTTCGGTCCCAATTTCGGTATTTCGGTGACTAAGGGGACTAGCGGTTGAGAAAGCGTCCAATTTCGGTACAATTTCCAATTTCGGCAATTTCGGTGCAATTTCCAATTTCGGTGCAATTTCGGTTGCGTCAATTTCGGTTGGATGTCGGACATAGGTGCAATTTCGGTCCTCACGGTATGTCAATTTCGGTACTTATTGCAATTTCCAATTTCGGTTCGGTTCCTCACCCAATTTCGGTCCGTTACATAGAGGTACCGCAATTTCAATTTCGGTTACCTCAATTTCGGTGGGTCTAGACCGCAACCACGGACGATCGGGAGAACACCTCGTCGGCTAAGGACAGGGCCAACAATTTCGGTTGTTATCAATCAATTTCGGTTTCGGTCAATTTCGGTATCGCCGTAGTACGTTTTTGGGTCAATTTCGGTGCGTGGGTAGAAACCAATAAACAATTTCGGTGGTACTACTCCGAGCTTGCATATTCGAGGATATGTACAATTTCGGTTGCACCTCGTTGTCAATTTCGGCAATTTCGGTGTTTGTCTTCAATTTCGGTTACCTGGTATCGCTGTGCATAGCGTCACCGTAGTAACAACATGTCATCCTTTCTACTAAATTCGGGGCTATCAGTCGTGTAGAAGATTATATTTTTGGGGGCGCGCACTCACCTATGAAGGAACCAACGTGCGCCCTGCGTATAGTTTGAGGGTACTCGGTGCGGTAAGGGATTAGCTTGAATAGTTTTAGAGATCCGAATGCCCATTTTTTCAATATGATCCGCCTTGGTCACTAGAAGAAGGAGTCACGGCATGCGGCAAGGTGGCTTGCAAGGCTCAAGGCCTAATAATTACAAGGGGGTACGGGTTTCGGAGCTGTCAAAGGAGCTGGACGCAGGAATACTCATTTGGTTTAGTGCGTCACGTAAAGATCGTCCTCAAGTCTAGCATATAGATGGTGCGCAACCGGTTCGCGGCTTATGTAAGCTCCTGGAAATAGGTTGGAACTAGGGAACACACTCCGTTTATCTCGAGGATGAAAGTATCAGTATGCCCCCTTTAAAAGTATCAGCCTAGGTATCCAAAGTATCAGAAAGTATCAGGCAAGAAAGTATCAGAGTATCAGAAACGGCACACAAAGTATCAGGAAAGTAAAAGTATCAGCTGCGGAAACGTCGAAAGTATCAGTCTGCGTAACCGCTAACCCCTAGTTTGGCCGCCAAAGTATCAAAGTATCAGAGCCGAAAGTATCAGCAAAGTATCAGGTTGGTACCCGTAGTAGACGACACACCAGAGAGGCGAAAGTATCAGAGTATCAGCCAAAGTATCAGGCCTAAAGTAAAAGTATCAGCAGGTTTAATTGTCGCAAAGTATCAGCAGTCCTCTCGCGAAAAGATAAAGAAAGTATCAGTGCTTAAAAGTATCAGCACCTCTGATCCGATAGAGATTCTGCCGGTGGTCGAAGAAGAAAGTATCAGCTAAAAACGTGTGAGCTTGCCAAAGTATCAGTATAATTCAGACCGGTGGCTTCCGAAAGTATCAGGTATCAGTCAGAGACTCAGTACTCCGTTGGTGTAAAAGTATCAGCATCAAAGTATCAGGGCCGGCCAAATATGGCTTAGGTGTCGTGAAGTTACACCACAGCACCTATGATTTCTCGTTGGCTTGTTTTGGAAAGGCCCGGGTCTAATTCTCTGAGTGGTCACTTAGAAAAAGGCAAATAGAGGATATCTCAGCAACAGCAAAGAGTTTCCTCTGGCTTGACCTCATGGGCTTAGCGTGAGGTACACATTATTCCTGGGGTAGGGATTATTGGAACCCAGGCGGGTGTTTGCCCCAAGGCGATAGAGGTCCCCTTACAGCGCAGAGGCTGTTCTTCCCGGGCATATCCCCTCTGAGGGCCTGACAATTTGAGTAATAGTCGGAGCGTAATTCTGAACCCCGCAAGTTACGCAGGCAATGAAGTGCCAATTGAGGTTAATGTAAATACTCCAGACACCTCCTCCGAACTCGGATCTTGCCCCACCACTCATGAAATCGTGATGGAGAAACGTAGGCGTAGGCGCTTCGGCTTAGGCGCTTCTAGTATTTCGCTCTGAGCTCGTAGGCGCTTCATAGTATTTCTTTAGGCGCTTCCAACTGGCTAGGGGCTAACCCTTAACGAATCACTATAGTAGGCGCTTCCATACAACTAGCGTACAAATTATAGGCGCTTCGCGCTTTTAGGCGCTTCAATAGGCTAGGCGCTTCGTTGTGCGTAGGCGCTTCGGAGATTTAGGCGCTTCGTACTGATAGGCGCTTCAGAGTACTTAGGCGCTTCGAGTGAGATAGGCGCTTCAGGAGGAATTTAGGCGCTTCGTAGGCGCTTCGGTAGTAGGCGCTTCAGCTAGGTCCTATCGTAGGCGCTTCATTCGGATGAAAATACGCTAAGGGATCACCGCCCTTATATTTGTGTGTAGGCTAGGCGCTTCTAGGCGCTTCGTAGGCGCTTCTTTAGGCGCTAGGCGCTTCCTTCGACTAGGCGCTTCGAAATTCGTTAGGCGCTTCGCTTCGCGGGCTAGCTAATTTGGGGGCGTCTAGGCGCTTCGGCGCTTCTCGGCGAAATCCATGCGTGGTGGTTTCACCGAACCCCCCGTAGAAGAGGGAATTGCTCTCCGAAATGGAGCTCGTTCTGGACCGGGAAAAGGGGCGCATCAGGTAGAATACCAGAAAGATTGGGCTCGACGGCAAAACTAGCTGTGGTTAATACTATCCCTTTTGATTCCCCACACCGGCTCGCTCGGATGTGCCGCATGATTGCATCAGAGAGGTCAGGGCAGTGCCGCCACGTGCCCTAGCACGGTCATGACATGCTTGTTGAAGTAAAATGCTTTAGGTGGCGTGGCGCCCGCCTATAAGCTCGGAAAACTTTCCCCCTCGCATGATAGCATAACGGATCACCGACCGGTTGCTCACCCGACGCAGGCGCCGCCGATCAATATACTCGAGGTAATTCGGGGGGCCGGCAGCTTAGGATCCTGCTGTGCCAGCAGCCTACAATCGCAGTCGCTATTAGGTAACAGCCTGAGTCATGACTAAGACCCTTTCCCGGCTGACCCCCATTCGCCACCAGTGCTATTTTGTTCAACTGACTATGCGGGTTTTGTTCAATGTGAGCTTTTGGTGTTCACAGACTAGAATGCATTTTGTTCAAAGTGGTCCCGACCTTTTGTTCAAGTTTTTTGTTCAACAGCAACCCCGCCCCCCGCCTTTTGTTCAAACCCCGCCGATCGCCGATTTTGTTCAACAAATGACTGGCCTTTTGTTCAACTTATTTGCCTTTTGTTCAATAACCCCCCGCCCCCCGCCGATCCGCCGATGATCATTTGTCTTTTGTTCAACGAACGTGGAATCGCCCCGCCGATTTTGTTCAAGAGTTTTTGTTCAATTGTTCTTTTGTTCAACCGATGGTTTTTGTTCAATTGTTTTTTGTTCAAGTTCAAATTTTGTTCAACCGCCGTTTTGTTCAACGATCCGCCGCCCCGCCGATCGCCGATCTTTTGTTTTTTGTTCAACCTTTTGTTCAAAAATCAAATGTTTTGTTCAACTTTTTGTTCAACCGCCGATAACAGGCCCCGCCTTTTGTTCAAGCCGATGCTTTTTTTTGTTCAAGGATTGATCAATCAACTATTTTTTTGTTCAATGTTCAATTTTGTTCAAGATCAAGATTGATGATTGATCAATCAAGACGCCCCCCGCCGATTGATTGATCAACGATTGATCAAGGGAGATTGATCAAAGTACTTGCCTTCATTCCGATTGATCAGATTGATCAAATATCTGGTGAGCGAGCGGATTGATCAAAAATCATGGGTCGATTGATCAATTGATCAACGTGGAGTGTCAGTGCCATGATTGATCAAGATTGATCAAAATGATTGATCAACAGTTATTGGATGCAGAAGCCAGGCCTCTTTCCAGGATACCGCAGATCGATTGATCAATTGATCAACACGAGCGGATGATTGATCAATCAACACGGATTGATCAATTCTTTGGAAGATTGATCAAAAATCAAGGACCCAAAGGCTATTACCTATATCCTACCGATAAACCGAAAAATTTGCTACGACCAAGCTGGCAGCCCTCAGGGTCGAGTGAATTCGTCGGGAGTCGGGTCGTTTGCGCAGCCGTCTCCTATAGCCTGAAGGCCCCCCGTTATATAACTCACGGCAGGCCAATAGCCGCCTTGTACAGGTAAAATAATGGATTTAGGCTGAGGGCGTACTACAAAGGAACCCCTCCAGTATTGCAGTTCTCCATGATGACGTTCACTGAAGGAACACTGGCTTGGGGATAGGTTCGTGACAAGGTCTGCGGGGTTTATGCCGGAACTAAGCTTGTAGAGCATTACAGACCCGAGTCTCGTTTTCTAATAGGAAGCGCCTAAGAGTTAAATGAACGCGCGAGGATACCACAAGTGTGAGCTCGCTTCGGACCAGGATTATTAGGCATATTTTCATTAAGTACATGCTCGTGTATATTTCAGGTTATCAGTCAGTACGCCATGGCTTATCTGATGCATTGGCACCTCCTCATTCTGCAGGCTTAGACTGCTTTGCTGGACGTGCGCGCTCAGAATGGTTCCGTAAGTAGTGCCATTTCATACCCTGCCACACTCTTTACGACCTGAAGTATCGTTCGCCGAGACAAACGGCCTGGCCTATCCACATACCCGCCCGTTGTAGGGGGGGTCTTTGGCCCAAGTGATGTGGTGATCTTGATTGGCATTGTAGATCCACGAGTACTATCATCTGCGTCGGCCTTTACTGGTCACCATGGTACTGTGTTGTGACTACGTGCGACACTTGGCACCTGTCGCCGCGTGGTGCCTTCAGTACCAAATATGGTGATAGATAGATATGGACGTGTTGGACGCAACTAGACTTTGACTCAACGGTGACATGCGGCCTATAATCAACGCTAGAGCAATCAATGCTGCAGAGGCGCCCAATCGTGGTTCGGCGTCCGGGTATGGTGAGAGATAAGTGCGCCATAGGTGAATCTTAGCCATGTAGTCAGTAGTACTGGACGCGTGAACATCTGATAAGCTCTCGGTTTTGTTGAAGTCCTTTGGAATGTAGGATACCACGGTATGTAGAAAAAAGTTAAGATCGGCGGATGGGGGGTTTGCCCTGGGAGGGGTACCGTTTACCTCGTGCTTTAAGCAGCTTTAGGAGTCAGACAATTAGCCGGAGCGATCCGTGGGCTCACACGAAGCTAAGTAATGTTAATGTCAGGGATTACGCGCTTGTGTCTGTCCCTTGCGTTTCCACCCTGGGACGCAATCTTTCAGCAGTGTTGCTTCGTCCCAATCCCTAAGATAGGTGGCAGTTTTCCATGAGTATTCTGTGAAACCGATCTAGAGACAAATCCGCGTGTATGCTACCAATCGGTCTTTATAGCGAGCCCGTATACACATTTACGACTCTGTCTGCAATGGCCAACAGGCATCCGAATGGCGTTTATTTATGCCTGCTTAACGCACTCGAAGTCGATGGCTAACAAGAAAAATTGCGTGGTTGTACCTGTCGATCGGTTGGAGACAAATGTGAGGGATTGTGACTTCAGATCTTAGACATGTCTTGCGGTGTGTTAGCCCCTCTAAGACCTCACGTCCTCCGACTATCATATGGCGAAGTGAG'
#l2='10 518 19'
p1,p2,p3= l2.split(' ')
zed= (superclumpfinder(l1,int(p1),int(p2),int(p3)))
#print(zed)


nkmers=0
for i in zed:
    #if zed[str(i)]==-1:
        nkmers=nkmers+1
        print (i ,end=" ")
print (nkmers)




